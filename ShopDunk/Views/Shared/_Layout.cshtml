<!DOCTYPE html>
<html data-bs-theme="dark">
@* <-- THÊM THUỘC TÍNH NÀY ĐỂ BẬT DARK MODE *@
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - ShopDunk</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <link href="~/Content/shopdunk.css?v=1.2" rel="stylesheet" />
</head>
<body>
    <nav class="navbar navbar-expand-lg main-navbar">
        <div class="container">
            <a class="navbar-brand" href="/">ThienStore</a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="mainNavbarContent">
                <ul class="navbar-nav nav-categories">
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/iPhone">iPhone</a></li>
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/iPad">iPad</a></li>
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/Mac">Mac</a></li>
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/Watch">Watch</a></li>
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/Âm thanh">Âm thanh</a></li>
                    <li class="nav-item"><a class="nav-link" href="/Product/Category/Phụ kiện">Phụ kiện</a></li>
                </ul>


                <form class="d-flex ms-auto me-3 w-25" role="search" method="get" action="@Url.Action("Search", "Product")">
                    <input class="form-control" type="search" placeholder="Tìm kiếm sản phẩm..." aria-label="Search" name="q">
                </form>

                <ul class="navbar-nav nav-icons">
                    <li class="nav-item"><a class="nav-link" href="/Cart"><i class="fas fa-shopping-cart"></i></a></li>

                    @* --- DROPDOWN CHO TÀI KHOẢN --- *@
                    @if (Session["Username"] != null)
                    {
                        @* KHI ĐÃ ĐĂNG NHẬP: Hiển thị Username *@
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarUserDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Chào, @Session["Username"]
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarUserDropdown">
                                <li><span class="dropdown-item-text fw-bold">@Session["Username"]</span></li>
                                <li><hr class="dropdown-divider"></li>
                                @if (Session["Role"]?.ToString() == "Admin")
                                {
                                    <li><a class="dropdown-item" href="@Url.Action("Index", "Admin")"><i class="fas fa-tachometer-alt me-2"></i> Trang Admin</a></li>
                                }

                                <li><a class="dropdown-item" href="@Url.Action("History", "Order")"><i class="fas fa-history me-2"></i> Lịch sử mua hàng</a></li>

                                <li><a class="dropdown-item" href="@Url.Action("ChangePassword", "Account")"><i class="fas fa-key me-2"></i> Đổi mật khẩu</a></li>
                                <li><a class="dropdown-item text-danger" href="/Account/Logout"><i class="fas fa-sign-out-alt me-2"></i> Đăng xuất</a></li>
                            </ul>
                        </li>
                    }
                    else
                    {
                        @* KHI CHƯA ĐĂNG NHẬP: Hiển thị link Đăng nhập / Đăng ký *@
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Login", "Account", new { returnUrl = Request.Url.PathAndQuery })">Đăng nhập</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="@Url.Action("Register", "Account", new { returnUrl = Request.Url.PathAndQuery })">Đăng ký</a>
                        </li>
                    }
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        @if (ViewBag.Title == "Trang chủ")
        {
            @RenderBody()
        }
        else
        {
            <div class="main-container p-4 p-md-5">
                @RenderBody()
            </div>
        }
    </div>

    <footer class="main-footer">
        <div class="container">
            <div class="row g-4">
                <div class="col-lg-4 col-md-6">
                    <h5>ThienStore</h5>
                    <p>ThienStore là đại lý uỷ quyền chính thức của Apple tại Việt Nam. Chúng tôi mang đến những sản phẩm Apple chính hãng với giá tốt nhất cùng dịch vụ chăm sóc khách hàng vượt trội.</p>
                </div>
                <div class="col-lg-2 col-md-6">
                    <h5>Sản phẩm</h5>
                    <ul>
                        <li><a href="/Product/Category/iPhone">iPhone</a></li>
                        <li><a href="/Product/Category/iPad">iPad</a></li>
                        <li><a href="/Product/Category/Mac">Mac</a></li>
                        <li><a href="/Product/Category/Watch">Watch</a></li>
                        <li><a href="/Product/Category/Âm thanh">Âm thanh</a></li>
                        <li><a href="/Product/Category/Phụ kiện">Phụ kiện</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5>Chính sách</h5>
                    <ul>
                        <li><a href="#">Chính sách bảo hành</a></li>
                        <li><a href="#">Chính sách đổi trả</a></li>
                        <li><a href="#">Chính sách bảo mật</a></li>
                        <li><a href="#">Chính sách giao hàng</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5>Liên hệ</h5>
                    <p>
                        <strong>Hotline:</strong> 1900.1234<br>
                        <strong>Email:</strong> support@thienstore.com<br>
                        <strong>Địa chỉ:</strong> 123 Nguyễn Văn Linh, Q.7, TP.HCM
                    </p>
                </div>
            </div>

            <div class="footer-bottom">
                <p>© 2025 ThienStore Clone. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    @RenderSection("scripts", required: false)
</body>
</html>